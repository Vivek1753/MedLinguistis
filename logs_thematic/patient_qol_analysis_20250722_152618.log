2025-07-22 15:26:18,909 - INFO - Configuration and logging setup complete.
2025-07-22 15:26:18,910 - INFO - Global MultiLabelBinarizer initialized.
2025-07-22 15:26:21,949 - INFO - Use pytorch device_name: cpu
2025-07-22 15:26:21,949 - INFO - Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
2025-07-22 15:26:25,298 - INFO - Loading sentiment analysis model: ProsusAI/finbert on device: cpu
2025-07-22 15:26:26,519 - INFO - Loading emotion classification model: cardiffnlp/twitter-roberta-base-emotion on device: cpu
2025-07-22 15:26:27,595 - INFO - Loading zero-shot classification model: facebook/bart-large-mnli on device: cpu
2025-07-22 15:26:28,434 - INFO - Use pytorch device_name: cpu
2025-07-22 15:26:28,434 - INFO - Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
2025-07-22 15:26:30,443 - INFO - Embedding function loaded: BAAI/bge-large-en-v1.5
2025-07-22 15:26:31,305 - INFO - Use pytorch device: cpu
2025-07-22 15:26:31,640 - INFO - Reranker model loaded: cross-encoder/ms-marco-MiniLM-L-6-v2
2025-07-22 15:26:31,972 - INFO - Loaded existing ChromaDB from ./chroma_db with 79 documents.
2025-07-22 15:26:31,972 - INFO - Attempting to connect to Ollama at: http://localhost:11434
2025-07-22 15:26:41,094 - INFO - Ollama connection successful. Test response: Hello! It's nice to meet you. Is there something I...
2025-07-22 15:26:49,305 - INFO - Combined narrative created from relevant fields.
2025-07-22 15:26:52,095 - INFO - Narratives preprocessed and labels assigned for main dataset.
2025-07-22 15:26:52,096 - INFO - Example multi-labels for first patient: [0 0 0 0 0]
2025-07-22 15:26:52,096 - INFO - Class distribution of 'dominant_label_id' before oversampling: Counter({0: 9, 1: 8, 4: 7, 2: 4, 3: 4})
2025-07-22 15:26:52,653 - INFO - Original number of narratives: 32
2025-07-22 15:26:52,653 - INFO - Number of chunks for classification after splitting: 79
2025-07-22 15:26:52,660 - INFO - Class distribution after oversampling: Counter({np.int64(1): 30, np.int64(4): 30, np.int64(0): 30, np.int64(3): 30, np.int64(2): 30})
2025-07-22 15:26:52,660 - INFO - Number of samples after oversampling: 150
2025-07-22 15:28:08,653 - INFO - Datasets tokenized for classification.
2025-07-22 15:28:08,668 - INFO - CustomDataCollatorWithPadding created.
2025-07-22 15:29:23,776 - INFO - Preparing to add 79 documents to ChromaDB.
2025-07-22 15:29:23,819 - INFO - Clearing existing ChromaDB collection before adding new documents.
2025-07-22 15:29:30,420 - INFO - ChromaDB populated and persisted with 79 documents.

2025-07-22 15:29:30,443 - ERROR - Error during thematic classification for patient Age                                    Zoe Bell
Gender                                 Zoe Bell
Ethnicity                              Zoe Bell
Marital_Status                         Zoe Bell
Occupation_Category                    Zoe Bell
Job_Title                              Zoe Bell
Weight_Current_Kg                      Zoe Bell
Weight_Lowest_Kg                       Zoe Bell
Weight_Highest_Kg                      Zoe Bell
Weight_Status                          Zoe Bell
BMI_Category                           Zoe Bell
Previous_Hernia_Repairs                Zoe Bell
Medical_History                        Zoe Bell
Medications                            Zoe Bell
QoL_Areas_Affected                     Zoe Bell
Symptoms_Restrictions_Activities       Zoe Bell
Symptoms_Adaptations_Face              Zoe Bell
Symptoms_Affect_Movement               Zoe Bell
Symptoms_Pain_Coping                   Zoe Bell
BodyImage_SelfConscious_Embarrassed    Zoe Bell
BodyImage_Others_Noticing              Zoe Bell
MentalHealth_Affected_Elaborate        Zoe Bell
MentalHealth_Coping_Strategies         Zoe Bell
Relationships_Social_Affected          Zoe Bell
Relationships_Intimate_Affected        Zoe Bell
Employment_What_Do_You_Do              Zoe Bell
Employment_Ability_To_Work_Affected    Zoe Bell
Employment_Changed_Work                Zoe Bell
Employment_Financial_Affected          Zoe Bell
SharedDecisionMaking_Questions         Zoe Bell
SharedDecisionMaking_Hopes             Zoe Bell
SharedDecisionMaking_Matters_To_You    Zoe Bell
Name: Patient_ID, dtype: object: text input must be of type `str` (single example), `list[str]` (batch or single pretokenized example) or `list[list[str]]` (batch of pretokenized examples).
