2025-07-22 00:39:11,299 - INFO - Configuration and logging setup complete.
2025-07-22 00:39:11,300 - INFO - Global MultiLabelBinarizer initialized.
2025-07-22 00:39:11,528 - INFO - Starting main execution...
2025-07-22 00:39:11,529 - INFO - Initializing tokenizer for thematic model: microsoft/BiomedNLP-PubMedBERT-base-uncased-abstract-fulltext
2025-07-22 00:39:12,131 - INFO - Loading data from data/patients_100a.json
2025-07-22 00:39:12,142 - INFO - Dataset loaded successfully! Total patients: 100
2025-07-22 00:39:12,158 - INFO - Combined narrative created from relevant fields.
2025-07-22 00:39:15,038 - INFO - Narratives preprocessed and labels assigned for main dataset.
2025-07-22 00:39:15,039 - INFO - Example multi-labels for first patient: [1 1 1 1 1]
2025-07-22 00:39:15,040 - INFO - Class distribution of 'dominant_label_id' before oversampling: Counter({1: 25, 0: 23, 2: 19, 3: 17, 4: 16})
2025-07-22 00:40:10,468 - INFO - Original number of narratives: 100
2025-07-22 00:40:10,468 - INFO - Number of chunks for classification after splitting: 7217
2025-07-22 00:40:10,483 - INFO - Class distribution after oversampling: Counter({np.int64(0): 1895, np.int64(2): 1895, np.int64(1): 1895, np.int64(4): 1895, np.int64(3): 1895})
2025-07-22 00:40:10,483 - INFO - Number of samples after oversampling: 9475
2025-07-22 00:41:07,456 - INFO - Datasets tokenized for classification.
2025-07-22 00:41:07,457 - INFO - CustomDataCollatorWithPadding created.
2025-07-22 00:41:07,458 - INFO - 
Combined Narrative for first patient (from consolidated data):
2025-07-22 00:41:07,459 - INFO - "Honestly, this hernia is a real pain, and it's impacting me more than I thought it would. It's not just a little bulge; it's a constant reminder that something's not right. Sitting at my computer all day as a Software Developer, I get this dragging ache, especially towards the end of the workday. I try to take breaks and walk around, but even a short walk now can trigger a throbbing pain.

What really gets to me is how it's affecting my life outside of work. I used to enjoy gardening, but now bending over to weed or plant something sends a sharp pain through my abdomen. And I'm not as active with my grandkids as I'd like to be. Lifting them is completely out of the question, and even chasing them around the park brings on this uncomfortable pressure. My previous repair lasted for so long, so this time round I was hoping to be much more comfortable in older age than I am currently feeling." "Ugh, this hernia... it's more than just a bulge, you know? It's taken over my life. I used to love coding at my standing desk all day, but now I have to sit most of the time because standing for too long makes it ache. I've bought these compression shorts – they're not exactly comfortable, especially in summer, but they give me some support and make me feel a little more secure. Socially, things have changed too. I used to be quite active with my friends, going for hikes, but now I mostly just suggest meeting for coffee. Sex? That's... well, let's just say it's become more complicated and less frequent. It's embarrassing, but I'm just not as confident anymore. And mentally, I'm a mess. I'm constantly worried about it getting worse, and it’s hard to concentrate on work. I even started seeing a therapist to help me deal with it all." Okay, here's a patient narrative, as a direct quote, describing how the hernia affects their general movement, based on the provided information:

"Honestly, this hernia is a real pain, literally. It's like a constant nagging feeling, a 'something's not right' kind of sensation. Bending over is the worst. If I have to pick something up from the floor, I have to be *so* careful and bend at the knees, keeping my back straight, because otherwise, I get this sharp jolt, like something's tearing. Twisting is also a no-go. Even just turning to reach for something on the desk at work can trigger a pulling sensation.

Standing up, especially after sitting for a while, is rough. It feels really stiff, and I have to brace myself. Getting out of bed in the morning? Forget about it being graceful. I have to roll onto my side first and then slowly push myself up, otherwise, I feel like I'm going to rip something open.

Walking... walking is okay, most of the time, but if I walk too far or too fast, I start to feel this heavy, dragging feeling. It's just this constant awareness that something's there, bulging, and fragile. It makes me really self-conscious about how I move, too. Like I'm constantly trying to protect it." "Honestly, it's a daily struggle. The discomfort is always there, like a dull ache. Some days are worse than others. When it really flares up, I'll take some paracetamol – that usually takes the edge off. I try not to rely on it too much though. I spend a lot of time at my computer for work, and I've had to adjust my chair and posture constantly, trying to find a position that puts less pressure on the hernia. Sometimes, if I can feel it bulging, I can gently push it back in, which gives me some relief. I also find that taking frequent breaks, just getting up and moving around a bit, helps to stop it from getting too aggravated. And I know it sounds silly, but sometimes just consciously focusing on my breathing, taking slow, deep breaths, seems to calm things down a little." "Honestly, I hate how this hernia makes me look. It's just...there. This bulge sticking out, especially on one side, makes me feel so asymmetrical and disfigured. I try to hide it with baggy clothes, but then I just feel like I'm hiding something. After my first surgery, I thought it would all be over, but this new one...it just feels even more prominent. It ruins my figure, and even though I know it sounds silly, sometimes I feel like I look pregnant. It's embarrassing, and it makes me so ashamed of my body." "It's hard to explain, but yeah, I definitely feel like people notice it. I've caught a few awkward glances, like they're trying to figure out what they're seeing. And once, someone actually asked if I was pregnant! I know they probably didn't mean anything by it, but it was so… humiliating. It just makes me feel so self-conscious and embarrassed to be seen. I hate the feeling of being scrutinized and I sometimes want to just shrink away and disappear." "It’s just… this hernia. It's always *there*, a constant reminder. I feel… trapped, honestly. Like my own body is betraying me. I find myself getting so irritable, snapping at my partner for the smallest things, then feeling guilty afterwards, which just makes everything worse. I used to really enjoy coding, it was my escape, but now, even sitting at the computer feels like a chore. I can't concentrate. The pain, the awareness of it… it's just a constant low hum of anxiety. I feel so… low. I know it sounds dramatic, but some days, I just feel a sense of dread wash over me for no reason. I keep thinking about that first surgery, the mesh… and what if this one doesn’t work either? What if I'm just stuck like this? It messes with my head, you know? Makes me feel… less like myself. It’s hard to explain, but it’s taken away so much of my joy. I hate looking at myself in the mirror. This isn’t me." "Honestly, the hernia just messes with my head. Some days are okay, but other days... I find myself just withdrawing. I used to love going out with friends, but lately, I've been canceling a lot. People mean well, but they always ask about it, and then I'm stuck thinking about it constantly. I try to distract myself, you know? Dive into work, get lost in a video game. Sometimes, it helps. Other times, I end up doom-scrolling online, looking for answers, and that just makes the anxiety worse. I definitely get more irritable too; my partner has noticed. I hate feeling like a burden, so I try to hide it, but it's hard. I did talk to my sister about it once, and that helped a little, but mostly, I just try to ignore it and hope it goes away, even though I know it won't." "It's… complicated. Socially, I mean. Before the hernia really flared up, I used to be a lot more active. I'm part of a board game group, and honestly, carrying the game bag and sitting for hours hunched over the table has become a real struggle. I've had to drop out of coordinating the weekly game night, which I really enjoyed.

And then there's… well, intimacy. The pain and just the way I feel about my body now makes it really hard to be close to people. It’s like I'm constantly aware of it, and it gets in the way, both physically and mentally. It’s strained my relationship with my partner, and honestly, I worry about becoming a burden. I used to enjoy going out dancing or to concerts, but now, the thought of being in a crowded space, moving around, is just… exhausting. I end up staying home more, and I feel like I'm slowly fading out of my friends' lives. It’s isolating, to be honest. I used to feel so connected, and now… I just feel like I'm watching from the sidelines." "It's hard to talk about, but this hernia… it’s really messed with my relationship. I feel so awkward about it. Sex isn't enjoyable like it used to be, there's just constant discomfort that makes me hesitant. I worry constantly about how it looks, how it feels to my partner. I feel less desirable, honestly. There’s this constant strain on the relationship now, and it breaks my heart. I feel guilty that I can't be as spontaneous or intimate as I used to be. It’s like this constant reminder of my body and its limitations, and it’s just… it's hard to connect emotionally when I'm so self-conscious and physically uncomfortable." "I work as a Software Developer, sitting at a desk most of the day." "Being a software developer, you wouldn't think a hernia would be a big deal. But honestly, the discomfort and anxiety are really impacting my work. It’s hard to concentrate when I'm constantly aware of the bulge in my abdomen. Some days, the pain makes it difficult to sit comfortably for extended periods, which is obviously a problem when you're coding all day. And it's not just the physical discomfort; it's the mental toll of knowing I had this fixed once before and it's back. That's affecting my focus and productivity, and honestly, my confidence in my ability to do my job properly." "I'm a software developer, so it's not like I'm doing heavy lifting, but honestly, this hernia's been messing with my concentration. I haven't changed jobs or anything, but I'm finding it harder to focus for long stretches. I'm starting to wonder if I'll eventually need to cut back on my hours, or maybe even look at a different type of role with less pressure, but I'm not quite there yet." "Financially, this hernia is a real pain. I'm a software developer, and focusing is hard with the discomfort. That's led to reduced productivity and honestly, I'm worried about getting less work and potentially reduced pay. The travel for all these appointments is adding up too. And the thought of potential complications down the line, and the medical bills that could come with that... it's definitely creating some financial anxiety for the future." "Okay, so, given my age and that I'm managing diabetes and high blood pressure, what are the biggest risks I should be aware of with this surgery specifically? I had a hernia repair before, back in '95, and I'm worried about recurrence. What are the chances of it coming back this time, and what kind of mesh are you planning to use? Also, being a software developer, I need to be able to sit at a desk comfortably. How long am I looking at before I can realistically get back to work, and what can I expect in terms of long-term pain management? Finally, I'm also self-conscious about how this looks. Is there anything that can be done to minimize scarring?" "Honestly, this hernia is really getting me down. It's not just the discomfort, which is bad enough, but it's affecting my whole life. I'm self-conscious about my body image, which is hitting my mental health hard. I’m finding it hard to focus at work as a software developer, and I’m snapping at my partner. I'm even avoiding social situations. It's impacting my relationships, both the social and, well, the more intimate side of things. I know I had a repair done years ago, but I'm really hoping this surgery will finally give me lasting relief from the pain and discomfort. More than anything, I want to feel comfortable in my own skin again, to feel good about myself, to be able to focus on my work and rebuild those connections with the people I care about. I want to be able to get back to normal, enjoy life to the fullest, and not let this hernia control me." "Honestly, this hernia...it's just sucking the joy out of everything. I'm a software developer, and I need to be able to focus. The discomfort is a constant distraction, affecting my concentration and productivity. It also impacts my mental health. I feel so much more irritable and down lately. I used to love hiking on the weekends, but now even a short walk leaves me exhausted. My biggest fear is not being able to stay active. More than anything, I want to feel comfortable in my own body again and get back to enjoying life. I want to be able to take my grandkids to the park without worrying about the pain, and feel like myself again. This is really affecting my sense of self."
2025-07-22 00:41:07,462 - INFO - Assigned Multi-Labels (names) for first patient: ['Symptoms and Function', 'Body Image', 'Mental Health', 'Interpersonal Relationships', 'Employment/Financial Concerns']
2025-07-22 00:41:07,462 - INFO - Preprocessed Narrative for first patient: honestlythisherniaisarealpainanditsimpactingmemorethanithoughtitwoulditsnotjustalittlebulgeitsaconstantreminderthatsomethingsnotrightsittingatmycomputeralldayasasoftwaredeveloperigetthisdraggingacheespeciallytowardstheendoftheworkdayitrytotakebreaksandwalkaroundbutevenashortwalknowcantriggerathrobbingpainwhatreallygetstomeishowitsaffectingmylifeoutsideofworkiusedtoenjoygardeningbutnowbendingovertoweedorplantsomethingsendsasharppainthroughmyabdomenandimnotasactivewithmygrandkidsasidliketobeliftingthemiscompletelyoutofthequestionandevenchasingthemaroundtheparkbringsonthisuncomfortablepressuremypreviousrepairlastedforsolongsothistimeroundiwashopingtobemuchmorecomfortableinolderagethaniamcurrentlyfeelingughthisherniaitsmorethanjustabulgeyouknowitstakenovermylifeiusedtolovecodingatmystandingdeskalldaybutnowihavetositmostofthetimebecausestandingfortoolongmakesitacheiveboughtthesecompressionshortstheyrenotexactlycomfortableespeciallyinsummerbuttheygivemesomesupportandmakemefeelalittlemoresecuresociallythingshavechangedtooiusedtobequiteactivewithmyfriendsgoingforhikesbutnowimostlyjustsuggestmeetingforcoffeesexthatswellletsjustsayitsbecomemorecomplicatedandlessfrequentitsembarrassingbutimjustnotasconfidentanymoreandmentallyimamessimconstantlyworriedaboutitgettingworseanditshardtoconcentrateonworkievenstartedseeingatherapisttohelpmedealwithitallokayheresapatientnarrativeasadirectquotedescribinghowtheherniaaffectstheirgeneralmovementbasedontheprovidedinformationhonestlythisherniaisarealpainliterallyitslikeaconstantnaggingfeelingasomethingsnotrightkindofsensationbendingoveristheworstifihavetopicksomethingupfromthefloorihavetobesocarefulandbendatthekneeskeepingmybackstraightbecauseotherwiseigetthissharpjoltlikesomethingstearingtwistingisalsoanogoevenjustturningtoreachforsomethingonthedeskatworkcantriggerapullingsensationstandingupespeciallyaftersittingforawhileisroughitfeelsreallystiffandihavetobracemyselfgettingoutofbedinthemorningforgetaboutitbeinggracefulihavetorollontomysidefirstandthenslowlypushmyselfupotherwiseifeellikeimgoingtoripsomethingopenwalkingwalkingisokaymostofthetimebutifiwalktoofarortoofastistarttofeelthisheavydraggingfeelingitsjustthisconstantawarenessthatsomethingstherebulgingandfragileitmakesmereallyselfconsciousabouthowimovetoolikeimconstantlytryingtoprotectithonestlyitsadailystrugglethediscomfortisalwaystherelikeadullachesomedaysareworsethanotherswhenitreallyflaresupilltakesomeparacetamolthatusuallytakestheedgeoffitrynottorelyonittoomuchthoughispendalotoftimeatmycomputerforworkandivehadtoadjustmychairandpostureconstantlytryingtofindapositionthatputslesspressureontheherniasometimesificanfeelitbulgingicangentlypushitbackinwhichgivesmesomereliefialsofindthattakingfrequentbreaksjustgettingupandmovingaroundabithelpstostopitfromgettingtooaggravatedandiknowitsoundssillybutsometimesjustconsciouslyfocusingonmybreathingtakingslowdeepbreathsseemstocalmthingsdownalittlehonestlyihatehowthisherniamakesmelookitsjusttherethisbulgestickingoutespeciallyononesidemakesmefeelsoasymmetricalanddisfigureditrytohideitwithbaggyclothesbutthenijustfeellikeimhidingsomethingaftermyfirstsurgeryithoughtitwouldallbeoverbutthisnewoneitjustfeelsevenmoreprominentitruinsmyfigureandeventhoughiknowitsoundssillysometimesifeellikeilookpregnantitsembarrassinganditmakesmesoashamedofmybodyitshardtoexplainbutyeahidefinitelyfeellikepeoplenoticeitivecaughtafewawkwardglancesliketheyretryingtofigureoutwhattheyreseeingandoncesomeoneactuallyaskedifiwaspregnantiknowtheyprobablydidntmeananythingbyitbutitwassohumiliatingitjustmakesmefeelsoselfconsciousandembarrassedtobeseenihatethefeelingofbeingscrutinizedandisometimeswanttojustshrinkawayanddisappearitsjustthisherniaitsalwaysthereaconstantreminderifeeltrappedhonestlylikemyownbodyisbetrayingmeifindmyselfgettingsoirritablesnappingatmypartnerforthesmallestthingsthenfeelingguiltyafterwardswhichjustmakeseverythingworseiusedtoreallyenjoycodingitwasmyescapebutnowevensittingatthecomputerfeelslikeachoreicantconcentratethepaintheawarenessofititsjustaconstantlowhumofanxietyifeelsolowiknowitsoundsdramaticbutsomedaysijustfeelasenseofdreadwashovermefornoreasonikeepthinkingaboutthatfirstsurgerythemeshandwhatifthisonedoesntworkeitherwhatifimjuststucklikethisitmesseswithmyheadyouknowmakesmefeellesslikemyselfitshardtoexplainbutitstakenawaysomuchofmyjoyihatelookingatmyselfinthemirrorthisisntmehonestlytheherniajustmesseswithmyheadsomedaysareokaybutotherdaysifindmyselfjustwithdrawingiusedtolovegoingoutwithfriendsbutlatelyivebeencancelingalotpeoplemeanwellbuttheyalwaysaskaboutitandthenimstuckthinkingaboutitconstantlyitrytodistractmyselfyouknowdiveintoworkgetlostinavideogamesometimesithelpsothertimesiendupdoomscrollingonlinelookingforanswersandthatjustmakestheanxietyworseidefinitelygetmoreirritabletoomypartnerhasnoticedihatefeelinglikeaburdensoitrytohideitbutitshardididtalktomysisteraboutitonceandthathelpedalittlebutmostlyijusttrytoignoreitandhopeitgoesawayeventhoughiknowitwontitscomplicatedsociallyimeanbeforetheherniareallyflaredupiusedtobealotmoreactiveimpartofaboardgamegroupandhonestlycarryingthegamebagandsittingforhourshunchedoverthetablehasbecomearealstruggleivehadtodropoutofcoordinatingtheweeklygamenightwhichireallyenjoyedandthenthereswellintimacythepainandjustthewayifeelaboutmybodynowmakesitreallyhardtobeclosetopeopleitslikeimconstantlyawareofitanditgetsinthewaybothphysicallyandmentallyitsstrainedmyrelationshipwithmypartnerandhonestlyiworryaboutbecomingaburdeniusedtoenjoygoingoutdancingortoconcertsbutnowthethoughtofbeinginacrowdedspacemovingaroundisjustexhaustingiendupstayinghomemoreandifeellikeimslowlyfadingoutofmyfriendslivesitsisolatingtobehonestiusedtofeelsoconnectedandnowijustfeellikeimwatchingfromthesidelinesitshardtotalkaboutbutthisherniaitsreallymessedwithmyrelationshipifeelsoawkwardaboutitsexisntenjoyablelikeitusedtobetheresjustconstantdiscomfortthatmakesmehesitantiworryconstantlyabouthowitlookshowitfeelstomypartnerifeellessdesirablehonestlytheresthisconstantstrainontherelationshipnowanditbreaksmyheartifeelguiltythaticantbeasspontaneousorintimateasiusedtobeitslikethisconstantreminderofmybodyanditslimitationsanditsjustitshardtoconnectemotionallywhenimsoselfconsciousandphysicallyuncomfortableiworkasasoftwaredevelopersittingatadeskmostofthedaybeingasoftwaredeveloperyouwouldntthinkaherniawouldbeabigdealbuthonestlythediscomfortandanxietyarereallyimpactingmyworkitshardtoconcentratewhenimconstantlyawareofthebulgeinmyabdomensomedaysthepainmakesitdifficulttositcomfortablyforextendedperiodswhichisobviouslyaproblemwhenyourecodingalldayanditsnotjustthephysicaldiscomfortitsthementaltollofknowingihadthisfixedoncebeforeanditsbackthatsaffectingmyfocusandproductivityandhonestlymyconfidenceinmyabilitytodomyjobproperlyimasoftwaredevelopersoitsnotlikeimdoingheavyliftingbuthonestlythisherniasbeenmessingwithmyconcentrationihaventchangedjobsoranythingbutimfindingithardertofocusforlongstretchesimstartingtowonderifilleventuallyneedtocutbackonmyhoursormaybeevenlookatadifferenttypeofrolewithlesspressurebutimnotquitethereyetfinanciallythisherniaisarealpainimasoftwaredeveloperandfocusingishardwiththediscomfortthatsledtoreducedproductivityandhonestlyimworriedaboutgettinglessworkandpotentiallyreducedpaythetravelforalltheseappointmentsisaddinguptooandthethoughtofpotentialcomplicationsdownthelineandthemedicalbillsthatcouldcomewiththatitsdefinitelycreatingsomefinancialanxietyforthefutureokaysogivenmyageandthatimmanagingdiabetesandhighbloodpressurewhatarethebiggestrisksishouldbeawareofwiththissurgeryspecificallyihadaherniarepairbeforebackin95andimworriedaboutrecurrencewhatarethechancesofitcomingbackthistimeandwhatkindofmeshareyouplanningtousealsobeingasoftwaredeveloperineedtobeabletositatadeskcomfortablyhowlongamilookingatbeforeicanrealisticallygetbacktoworkandwhatcaniexpectintermsoflongtermpainmanagementfinallyimalsoselfconsciousabouthowthislooksisthereanythingthatcanbedonetominimizescarringhonestlythisherniaisreallygettingmedownitsnotjustthediscomfortwhichisbadenoughbutitsaffectingmywholelifeimselfconsciousaboutmybodyimagewhichishittingmymentalhealthhardimfindingithardtofocusatworkasasoftwaredeveloperandimsnappingatmypartnerimevenavoidingsocialsituationsitsimpactingmyrelationshipsboththesocialandwellthemoreintimatesideofthingsiknowihadarepairdoneyearsagobutimreallyhopingthissurgerywillfinallygivemelastingrelieffromthepainanddiscomfortmorethananythingiwanttofeelcomfortableinmyownskinagaintofeelgoodaboutmyselftobeabletofocusonmyworkandrebuildthoseconnectionswiththepeopleicareaboutiwanttobeabletogetbacktonormalenjoylifetothefullestandnotletthisherniacontrolmehonestlythisherniaitsjustsuckingthejoyoutofeverythingimasoftwaredeveloperandineedtobeabletofocusthediscomfortisaconstantdistractionaffectingmyconcentrationandproductivityitalsoimpactsmymentalhealthifeelsomuchmoreirritableanddownlatelyiusedtolovehikingontheweekendsbutnowevenashortwalkleavesmeexhaustedmybiggestfearisnotbeingabletostayactivemorethananythingiwanttofeelcomfortableinmyownbodyagainandgetbacktoenjoyinglifeiwanttobeabletotakemygrandkidstotheparkwithoutworryingaboutthepainandfeellikemyselfagainthisisreallyaffectingmysenseofself
2025-07-22 00:41:07,464 - INFO - Loading fine-tuned thematic model from ./qol_classifier_fine_tuned for inference.
2025-07-22 00:41:07,464 - ERROR - Failed to load fine-tuned thematic model from ./qol_classifier_fine_tuned: Repo id must use alphanumeric chars or '-', '_', '.', '--' and '..' are forbidden, '-' and '.' cannot start or end the name, max length is 96: './qol_classifier_fine_tuned'.
2025-07-22 00:41:07,465 - INFO - Falling back to loading a fresh model from Hugging Face Hub (without fine-tuning) for this session.
2025-07-22 00:41:09,714 - INFO - Fresh model loaded and moved to: cpu
2025-07-22 00:41:09,719 - INFO - Use pytorch device_name: cpu
2025-07-22 00:41:09,719 - INFO - Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
2025-07-22 00:41:42,610 - INFO - SentenceTransformer for keyword expansion loaded.
2025-07-22 00:41:42,611 - INFO - Using emotion model name: cardiffnlp/twitter-roberta-base-emotion
2025-07-22 00:41:42,611 - INFO - Loading sentiment analysis model: ProsusAI/finbert on device: -1
2025-07-22 00:41:43,510 - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-07-22 00:41:55,629 - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-07-22 00:41:56,634 - INFO - Loading emotion classification model: cardiffnlp/twitter-roberta-base-emotion on device: -1
2025-07-22 00:41:58,226 - INFO - Loading zero-shot classification model: facebook/bart-large-mnli on device: -1
2025-07-22 00:41:58,689 - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-07-22 00:42:42,177 - INFO - Applying sentiment and emotion analysis to narratives...
2025-07-22 00:43:50,831 - INFO - Sentiment and emotion analysis completed.
2025-07-22 00:43:50,850 - INFO - Applying mental health linguistic signal detection (Zero-Shot Classification)....

2025-07-22 01:27:50,544 - INFO - Mental health linguistic signal detection completed.
2025-07-22 01:27:50,556 - INFO - Preparing documents for vector store...
2025-07-22 01:28:43,093 - INFO - Number of documents for vectorstore: 7217
2025-07-22 01:28:43,111 - INFO - Use pytorch device_name: cpu
2025-07-22 01:28:43,111 - INFO - Load pretrained SentenceTransformer: BAAI/bge-large-en-v1.5
2025-07-22 01:28:45,442 - INFO - Embedding function loaded: BAAI/bge-large-en-v1.5
2025-07-22 01:28:46,692 - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-07-22 01:28:52,585 - INFO - Use pytorch device: cpu
2025-07-22 01:28:52,927 - INFO - Reranker model loaded: cross-encoder/ms-marco-MiniLM-L-6-v2
2025-07-22 01:28:53,239 - WARNING - ChromaDB collection is empty at path or just created. It will be populated when documents are added.
2025-07-22 01:28:53,240 - INFO - Attempting to connect to Ollama at: https://b37f03b3d465.ngrok-free.app
2025-07-22 01:28:53,550 - ERROR - FAILED TO CONNECT TO OLLAMA at https://b37f03b3d465.ngrok-free.app. Details: Ollama call failed with status code 404. Maybe your model is not found and you should pull the model with `ollama pull llama3:8b-instruct-q8_0`.
2025-07-22 01:28:53,551 - ERROR - Ensure Ollama is running, the model is pulled, and ngrok (or direct access) is correctly configured.
2025-07-22 01:28:53,551 - INFO - Preparing to add 7217 documents to ChromaDB.
2025-07-22 01:28:53,552 - INFO - Documents exceed max batch size (5461). Splitting into batches.
2025-07-22 01:30:10,843 - INFO - Added batch 1/2 (5461 documents).

2025-07-22 01:30:37,899 - INFO - Added batch 2/2 (1756 documents).

2025-07-22 01:30:37,900 - INFO - ChromaDB populated and persisted with all 7217 documents in batches.

2025-07-22 01:30:37,901 - INFO - 
--- Generating a Sample Comprehensive QoL Report ---

